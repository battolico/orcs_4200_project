\section{Data and Experimental Setup}

% In this study, we utilize the KuaiRec dataset, which offers a highly dense user-item interaction matrix coupled with rich contextual information about both users and items. As described, the “small matrix” subset within KuaiRec is $99.6\%$ dense, making it particularly suitable for reliable training and evaluation. We focus on the subset due to its completeness, ensuring minimal uncertainty caused by missing data and reducing the need for extensive imputation or filtering.

For the project we decided to use the KuaiRec dataset \cite{gao2022kuairec}, and specifically we are going to use the small\_matrix.csv data set. The KuaiRec data set is a " real-world dataset collected from the recommendation logs of the video-sharing mobile app Kuaishou" \cite{gao2022kuairec}. What is different about this project, which is using MABs to model a recommendation system, is that the matrix data that we are going to use contains a fully observed user-item interaction matrix. In most recommendation systems the data that is used to train the system is very sparse, meaning that a user has not interacted with all the possible options which prevents us from making accurate predictions about other types of categories that the user might like. If we are building a music recommendation system, it might not be able to tell whether a user likes classical music if they only interacted with rock music until now. This is especially an issue when we are dealing with the cold start problem - when a new user enters the system and we have no historic data on their preferences \cite{nath2023_medium}. Being able to pursue research with a complete user-item interaction enables us to create a strong recommendation system.


\subsection{Data Description and Preprocessing}

The KuaiRec dataset comprises interactions between users and videos, along with item-specific metadata (e.g., categories, temporal information) and user-specific features (e.g., demographics, social connections, usage patterns). Each user-video interaction record includes a watch ratio, indicating the proportion of the video consumed by the user, which can serve as a proxy for user engagement or reward.

We first start by cleaning the data set. This involves by replacing NaNs, which we decide to replace by the median value. This was done in order to preserve the data, without throwing away important information. We also looked into using a KNN imputer, however that was computationally too long, so we opted to use the median. Non-numeric or malformed entries were either removed or assigned a placeholder value (\(-124\) for unknown categories). Some feature engineering was also done, in order to levergage more contextual information. The code merges the small\_matrix with two other data sets: item\_categories, and video\_categories. Then a binary feature "like" is added, based on the watch ratio column, where a watch ratio greater than 2 indicates that the video was indeed "liked". Then the data was pivoted, o produce a user-by-category matrix that represents how each user engaged with each first-level video category, \textbf{sum of liked videos} across relevant videos. These transformations allowed us to directly incorporate contextual vectors into the LinUCB framework. Lastly, in order for the model to work, temporal features had to be converted to a numerical value. This was done by converting the date to the number of seconds elapsed since the lowest date time of the feature.
